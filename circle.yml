test:
  pre:
    # install python client
    - pip install git+https://github.com/demisto/demisto-py.git@test-content

    # validate yaml
    - chmod +x ./Tests/yamlvalidator
    - ./Tests/yamlvalidator

    # build content descriptor
    - ./setContentDescriptor.sh $CIRCLE_BUILD_NUM 8e9341415ae7823ae6108bad79bd938a56ded0cf 3.0.5

    # create content bundle
    - mkdir bundle
    - cd Tools/ && for i in */ ; do zip -jr "../bundle/tools-${i%/}.zip" "$i"; done
    - cp Integrations/* bundle/
    - cp Misc/* bundle/
    - cp Playbooks/* bundle/
    - cp Reports/* bundle/
    - cp content-descriptor.json bundle/
    - cp $(find Scripts -type f -print) bundle/

    - cd bundle/ && zip ../content.zip *
    - cp content.zip $CIRCLE_ARTIFACTS/content.zip
    - cp release-notes.txt $CIRCLE_ARTIFACTS/
  override: